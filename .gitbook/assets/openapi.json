{"openapi":"3.0.2","info":{"title":"中台接口","description":"中台相关接口","version":"0.1.0"},"paths":{"/api/device/":{"get":{"tags":["device"],"summary":"获取所有设备的详细信息","description":"获取所有设备的详细信息","operationId":"get_device_api_device__get","parameters":[{"description":"开始时间时间戳","required":false,"schema":{"title":"Start Time","type":"string","description":"开始时间时间戳","default":"now-1d"},"name":"start_time","in":"query"},{"description":"结束时间时间戳","required":false,"schema":{"title":"End Time","type":"string","description":"结束时间时间戳","default":"now"},"name":"end_time","in":"query"},{"description":"探针id列表","required":false,"schema":{"title":"Probe Ids","type":"array","items":{"type":"string"},"description":"探针id列表"},"name":"probe_ids","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Get Device Api Device  Get","type":"array","items":{"$ref":"#/components/schemas/ModelDevice"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/device/{_id}/":{"put":{"tags":["device"],"summary":"更新设备信息","description":"更新设备信息","operationId":"update_device_api_device___id___put","parameters":[{"required":true,"schema":{"title":" Id","type":"string"},"name":"_id","in":"path"}],"requestBody":{"content":{"application/json":{"schema":{"title":"Item","anyOf":[{"$ref":"#/components/schemas/RequsetDeviceUpdateProbe"},{"$ref":"#/components/schemas/RequsetDeviceUpdateType"}]}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelDevice"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/device/running":{"get":{"tags":["device"],"summary":"获取特定设备硬件运行信息","description":"计算探针/中台/边代的运行状态(cpu, 内存, 存储)","operationId":"get_device_running_old_api_device_running_get","parameters":[{"description":"时间长度","required":true,"schema":{"title":"Period","pattern":"^[0-9]*(hour|day|week|month)[s]?$","type":"string","description":"时间长度"},"name":"period","in":"query"},{"description":"时间间隔","required":false,"schema":{"title":"Interval","pattern":"^[0-9]*(minute|hour|day|week)[s]?$","type":"string","description":"时间间隔"},"name":"interval","in":"query"},{"description":"探针id列表","required":false,"schema":{"title":"Probe Ids","type":"array","items":{"type":"string"},"description":"探针id列表"},"name":"probe_ids","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Get Device Running Old Api Device Running Get","type":"object","additionalProperties":{"$ref":"#/components/schemas/ModelDeviceRunningOld"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"deprecated":true,"security":[{"APIKeyHeader":[]}]}},"/api/device_monitorings":{"get":{"tags":["device"],"summary":"获取特定设备硬件运行信息","description":"计算探针/中台/边代的运行状态(cpu, 内存, 存储)","operationId":"get_device_monitorings_api_device_monitorings_get","parameters":[{"description":"时间长度","required":true,"schema":{"title":"Period","pattern":"^[0-9]*(hour|day|week|month)[s]?$","type":"string","description":"时间长度"},"name":"period","in":"query"},{"description":"时间间隔","required":false,"schema":{"title":"Interval","pattern":"^[0-9]*(minute|hour|day|week)[s]?$","type":"string","description":"时间间隔"},"name":"interval","in":"query"},{"description":"探针id列表","required":false,"schema":{"title":"Probe Ids","type":"array","items":{"type":"string"},"description":"探针id列表"},"name":"probe_ids","in":"query"},{"description":"设备id列表","required":false,"schema":{"title":"Device Ids","type":"array","items":{"type":"string"},"description":"设备id列表"},"name":"device_ids","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Get Device Monitorings Api Device Monitorings Get","type":"array","items":{"$ref":"#/components/schemas/ModelDeviceRunning"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/connection":{"get":{"tags":["device"],"summary":"获取设备间的物理/网络连接关系","description":"获取连接关系","operationId":"get_device_relation_api_connection_get","parameters":[{"required":false,"schema":{"title":"连接类型","allOf":[{"$ref":"#/components/schemas/ModelRelationType"}],"default":"physical"},"name":"relation_type","in":"query"},{"description":"探针id列表","required":false,"schema":{"title":"Probe Ids","type":"array","items":{"type":"string"},"description":"探针id列表"},"name":"probe_ids","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Get Device Relation Api Connection Get","type":"array","items":{"$ref":"#/components/schemas/ModelDeviceConnection"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/device/{main_id}/merge":{"put":{"tags":["device"],"summary":"合并设备","description":"合并设备","operationId":"get_device_merge_api_device__main_id__merge_put","parameters":[{"required":true,"schema":{"title":"Main Id","type":"string"},"name":"main_id","in":"path"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequsetDeviceMerge"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"deprecated":true,"security":[{"APIKeyHeader":[]}]}},"/api/device_errors":{"get":{"tags":["device"],"summary":"获取设备异常","description":"获取设备异常并返回","operationId":"get_device_errors_api_device_errors_get","parameters":[{"description":"开始时间时间戳","required":false,"schema":{"title":"Start Time","type":"string","description":"开始时间时间戳","default":"now-1d"},"name":"start_time","in":"query"},{"description":"结束时间时间戳","required":false,"schema":{"title":"End Time","type":"string","description":"结束时间时间戳","default":"now"},"name":"end_time","in":"query"},{"description":"异常类型列表","required":false,"schema":{"title":"Error Types","type":"array","items":{"type":"string"},"description":"异常类型列表"},"name":"error_types","in":"query"},{"description":"探针id列表","required":false,"schema":{"title":"Probe Ids","type":"array","items":{"type":"string"},"description":"探针id列表"},"name":"probe_ids","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/tasks/{_id}/":{"get":{"tags":["task"],"summary":"根据任务id查询任务","description":"获取任务的状态并返回","operationId":"get_task_status_api_tasks___id___get","parameters":[{"required":true,"schema":{"title":" Id","type":"string"},"name":"_id","in":"path"},{"description":"探针id列表","required":false,"schema":{"title":"Probe Ids","type":"array","items":{"type":"string"},"description":"探针id列表"},"name":"probe_ids","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseTaskStatus"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/tasks/":{"get":{"tags":["task"],"summary":"获取所有任务信息列表","description":"获取任务的状态列表并返回","operationId":"get_task_list_api_tasks__get","parameters":[{"description":"任务id列表","required":true,"schema":{"title":"Task Ids","type":"array","items":{"type":"string"},"description":"任务id列表"},"name":"task_ids","in":"query"},{"description":"探针id列表","required":false,"schema":{"title":"Probe Ids","type":"array","items":{"type":"string"},"description":"探针id列表"},"name":"probe_ids","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Get Task List Api Tasks  Get","type":"array","items":{"$ref":"#/components/schemas/ResponseTaskStatus"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/malicious/{mal_type}/{data}":{"get":{"tags":["malicious"],"summary":"根据类型和数据查询相关的威胁情报信息","description":"数据类型支持: ip, hash, url, domain。请将斜杠(/)替换为'2F'(含单引号)","operationId":"get_malicious_api_malicious__mal_type___data__get","parameters":[{"required":true,"schema":{"$ref":"#/components/schemas/MalType"},"name":"mal_type","in":"path"},{"required":true,"schema":{"title":"Data","type":"string"},"name":"data","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Get Malicious Api Malicious  Mal Type   Data  Get","type":"array","items":{"$ref":"#/components/schemas/MalRes"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/malicious/search/id/{data}":{"get":{"tags":["malicious"],"summary":"获取特定id的威胁情报信息","description":"获取特定id的威胁情报信息","operationId":"get_malicious_by_id_api_malicious_search_id__data__get","parameters":[{"description":"mal_id","required":true,"schema":{"title":"Mal Id","type":"integer","description":"mal_id"},"name":"mal_id","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MalResSingle"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/vuln/list":{"get":{"tags":["vuln"],"summary":"获取所有漏洞信息列表","description":"获取漏洞并返回","operationId":"get_vuln_list_api_vuln_list_get","parameters":[{"description":"开始时间时间戳","required":false,"schema":{"title":"Start Time","type":"string","description":"开始时间时间戳","default":"now-1d"},"name":"start_time","in":"query"},{"description":"结束时间时间戳","required":false,"schema":{"title":"End Time","type":"string","description":"结束时间时间戳","default":"now"},"name":"end_time","in":"query"},{"description":"语言","required":false,"schema":{"allOf":[{"$ref":"#/components/schemas/VulnLang"}],"description":"语言","default":"english"},"name":"lang","in":"query"},{"description":"探针id列表","required":false,"schema":{"title":"Probe Ids","type":"array","items":{"type":"string"},"description":"探针id列表"},"name":"probe_ids","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}}},"components":{"schemas":{"Channel":{"title":"Channel","type":"object","properties":{"name":{"title":"Name","type":"string","description":"通道名称"},"channel_index":{"title":"Channel Index","type":"integer","description":"通道编号"},"ip_address":{"title":"Ip Address","type":"string","format":"ipv4"},"port":{"title":"Port","type":"integer"},"state":{"allOf":[{"$ref":"#/components/schemas/ChannelState"}],"description":"通道状态","default":"offline"},"protocol":{"$ref":"#/components/schemas/Protocol"},"channel_type":{"$ref":"#/components/schemas/ChannelType"}},"description":"nvr通道字段"},"ChannelState":{"title":"ChannelState","enum":["online","offline","login_failed"],"description":"通道状态映射"},"ChannelType":{"title":"ChannelType","enum":["IP","Analog"],"description":"通道类型映射"},"DeviceDetail":{"title":"DeviceDetail","required":["ip"],"type":"object","properties":{"id":{"title":"设备id","type":"string"},"ip":{"title":"设备ip","anyOf":[{"type":"string","format":"ipv4"},{"type":"string","format":"ipv6"}]}},"description":"设备信息"},"DeviceType":{"title":"DeviceType","enum":["pc","phone","pad","tv","ipc","nvr","switch","server","plat","probe","unidentified","non_intelligent","plc","control_system","printer","edge_agent","gateway","electricMeter","tempHumi","leakDetector","gasDetector","liquidLevel","photovoltaics"],"description":"设备类型映射"},"DeviceTypeReverse":{"title":"DeviceTypeReverse","enum":["PC","PHONE","PAD","TV","IPC","NVR","SWITCH","server","Plat","Probe","Unknown","non_intelligent","PLC","control system","printer","edge_agent","gateway","electricMeter","tempHumi","leakDetector","gasDetector","liquidLevel","photovoltaics"],"description":"设备类型映射(反向)\nfor k,v in DeviceType.__members__.items():\n    print(f'{v.value} = \"{k}\"')"},"HTTPValidationError":{"title":"HTTPValidationError","type":"object","properties":{"detail":{"title":"Detail","type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}},"Ipasset":{"title":"Ipasset","type":"object","properties":{"ip_address":{"title":"Ip Address","type":"string","description":"设备ip","format":"ipv4"},"netmask":{"title":"Netmask","type":"string","description":"掩码","format":"ipv4"},"gateway":{"title":"Gateway","type":"string","format":"ipv4"}},"description":"ip字段"},"MalArtifact":{"title":"MalArtifact","required":["dataType","data"],"type":"object","properties":{"dataType":{"title":"数据类型","type":"string"},"message":{"title":"Message","type":"string"},"tlp":{"title":"Tlp","type":"integer"},"tags":{"title":"Tags","type":"array","items":{"type":"string"}},"startDate":{"title":"Startdate","type":"string","format":"date-time"},"ioc":{"title":"Ioc","type":"boolean"},"data":{"title":"内容","type":"string"}},"description":"artifacts"},"MalRes":{"title":"MalRes","required":["data","dataType","sourceRef","severity","lastSyncDate","createdAt"],"type":"object","properties":{"data":{"title":"内容","type":"string"},"dataType":{"title":"数据类型","type":"string"},"sourceRef":{"title":"事件id","type":"integer"},"severity":{"title":"严重程度","type":"integer"},"title":{"title":"标题","type":"string"},"description":{"title":"描述","type":"string"},"lastSyncDate":{"title":"最后同步时间","type":"string","format":"date-time"},"createdAt":{"title":"创建时间","type":"string","format":"date-time"},"startDate":{"title":"Startdate","type":"string","format":"date-time"},"date":{"title":"Date","type":"string","format":"date-time"},"follow":{"title":"Follow","type":"boolean"},"tlp":{"title":"Tlp","type":"integer"},"source":{"title":"Source","type":"string"},"type":{"title":"Type","type":"string"},"status":{"title":"Status","type":"string"},"tags":{"title":"Tags","type":"array","items":{"type":"string"}},"caseTemplate":{"title":"Casetemplate","type":"string"},"relations":{"title":"Relations","type":"string"},"message":{"title":"Message","type":"string"},"ioc":{"title":"Ioc","type":"boolean"},"customFields":{"title":"Customfields","type":"object"}},"description":"response"},"MalResSingle":{"title":"MalResSingle","required":["sourceRef","severity","createdAt","lastSyncDate","artifacts"],"type":"object","properties":{"sourceRef":{"title":"事件id","type":"integer"},"severity":{"title":"严重程度","type":"integer"},"tlp":{"title":"Tlp","type":"integer"},"title":{"title":"标题","type":"string"},"description":{"title":"描述","type":"string"},"createdAt":{"title":"创建时间","type":"string","format":"date-time"},"lastSyncDate":{"title":"最后同步时间","type":"string","format":"date-time"},"date":{"title":"Date","type":"string","format":"date-time"},"artifacts":{"title":"关联","type":"array","items":{"$ref":"#/components/schemas/MalArtifact"}},"tags":{"title":"Tags","type":"array","items":{"type":"string"}},"follow":{"title":"Follow","type":"boolean"},"source":{"title":"Source","type":"string"},"type":{"title":"Type","type":"string"},"status":{"title":"Status","type":"string"},"caseTemplate":{"title":"Casetemplate","type":"string"},"relations":{"title":"Relations","type":"string"},"customFields":{"title":"Customfields","type":"object"}},"description":"response"},"MalType":{"title":"MalType","enum":["ip","hash","url","domain"],"description":"恶意数据类型"},"ModelDevice":{"title":"ModelDevice","required":["update_time","status"],"type":"object","properties":{"type":{"title":"Type","anyOf":[{"$ref":"#/components/schemas/DeviceType"},{"type":"string"}],"description":"设备类型","default":"unidentified"},"mac":{"title":"Mac","type":"string"},"manufacturer":{"title":"Manufacturer","type":"string","description":"厂商英文"},"vendor_in_chinese":{"title":"Vendor In Chinese","type":"string","description":"厂商中文"},"update_time":{"title":"Update Time","type":"string","format":"date-time"},"create_time":{"title":"Create Time","type":"string","description":"创建时间","format":"date-time","default":"2021-12-13T01:25:16.782856+00:00"},"id":{"title":"Id","type":"string","description":"设备id"},"ip":{"title":"Ip","type":"string","description":"设备ip","format":"ipv4"},"public_ip":{"title":"Public Ip","type":"string","description":"管理ip"},"status":{"title":"Status","anyOf":[{"$ref":"#/components/schemas/Status"},{"type":"string"}],"description":"设备在线状态"},"subnet_mask":{"title":"Subnet Mask","type":"string","description":"掩码","format":"ipv4"},"gateway":{"title":"Gateway","type":"string","format":"ipv4"},"name":{"title":"Name","type":"string"},"system_operation":{"title":"System Operation","type":"string","description":"操作系统"},"system_version":{"title":"System Version","type":"string","description":"系统版本号"},"cpu":{"title":"Cpu","type":"string","description":"cpu型号"},"memory":{"title":"Memory","type":"string","description":"内存容量"},"storage":{"title":"Storage","type":"string","description":"硬盘容量"},"model":{"title":"Model","type":"string","description":"设备型号"},"version":{"title":"Version","type":"string"},"serial_num":{"title":"Serial Num","type":"string","description":"序列号"},"switch":{"$ref":"#/components/schemas/Switch"},"non_intelligent":{"$ref":"#/components/schemas/NonIntelligent"},"nvr":{"$ref":"#/components/schemas/NVR"},"dvr":{"$ref":"#/components/schemas/NVR"},"subnets":{"title":"Subnets","type":"array","items":{"type":"string"},"description":"管理网段"},"cert":{"title":"Cert","type":"object","description":"证书"},"probe":{"$ref":"#/components/schemas/Probe"},"videorecorder":{"$ref":"#/components/schemas/NVR"},"ipasset":{"$ref":"#/components/schemas/Ipasset"},"Lat":{"title":"Lat","type":"number","description":"经度"},"Lng":{"title":"Lng","type":"number","description":"纬度"},"address":{"title":"Address","type":"string","description":"省/市/区"},"location":{"title":"Location","type":"string","description":"详细地址"},"switch_belong":{"title":"Switch Belong","type":"string","description":"所属交换机"},"edge_belong":{"title":"Edge Belong","type":"string","description":"所属边代"},"wireguard_ip":{"title":"Wireguard Ip","type":"string","description":"wireguard ip","format":"ipv4"},"score":{"title":"Score","type":"number","description":"持续信任评估分数","default":0.5}},"description":"/api/device字段"},"ModelDeviceConnection":{"title":"ModelDeviceConnection","required":["device1","device2"],"type":"object","properties":{"device1":{"title":"Device1","type":"string"},"device2":{"title":"Device2","type":"string"},"protocol":{"title":"Protocol","type":"string"},"port":{"title":"Port","type":"integer"},"service":{"title":"Service","type":"string"},"num":{"title":"Num","type":"integer"}},"description":"/api/connection的响应"},"ModelDeviceRunning":{"title":"ModelDeviceRunning","required":["storage_total","storage_used","cpu_history","cpu_history_time","mem_total","mem_used_history","mem_used_history_time","device"],"type":"object","properties":{"storage_total":{"title":"存储总量","pattern":"[0-9]+\\.[0-9]+G$","type":"string"},"storage_used":{"title":"存储使用量","pattern":"[0-9]+\\.[0-9]+G$","type":"string"},"cpu_history":{"title":"CPU使用历史","pattern":"[0-9]+\\.[0-9]+%$","type":"array","items":{"pattern":"[0-9]+\\.[0-9]+%$","type":"string"}},"cpu_history_time":{"title":"CPU使用历史横轴","type":"array","items":{"type":"string"}},"mem_total":{"title":"内存总量","pattern":"[0-9]+\\.[0-9]+G$","type":"string"},"mem_used_history":{"title":"内存使用历史","pattern":"[0-9]+\\.[0-9]+G$","type":"array","items":{"pattern":"[0-9]+\\.[0-9]+G$","type":"string"}},"mem_used_history_time":{"title":"内存使用历史横轴","type":"array","items":{"type":"string"}},"device":{"$ref":"#/components/schemas/RunningDevice"}},"description":"/api/device/running的响应"},"ModelDeviceRunningOld":{"title":"ModelDeviceRunningOld","required":["storage_total","storage_used","cpu_history","cpu_history_time","mem_total","mem_used_history","mem_used_history_time"],"type":"object","properties":{"storage_total":{"title":"存储总量","pattern":"[0-9]+\\.[0-9]+G$","type":"string"},"storage_used":{"title":"存储使用量","pattern":"[0-9]+\\.[0-9]+G$","type":"string"},"cpu_history":{"title":"CPU使用历史","pattern":"[0-9]+\\.[0-9]+%$","type":"array","items":{"pattern":"[0-9]+\\.[0-9]+%$","type":"string"}},"cpu_history_time":{"title":"CPU使用历史横轴","type":"array","items":{"type":"string"}},"mem_total":{"title":"内存总量","pattern":"[0-9]+\\.[0-9]+G$","type":"string"},"mem_used_history":{"title":"内存使用历史","pattern":"[0-9]+\\.[0-9]+G$","type":"array","items":{"pattern":"[0-9]+\\.[0-9]+G$","type":"string"}},"mem_used_history_time":{"title":"内存使用历史横轴","type":"array","items":{"type":"string"}}},"description":"/api/device/running的响应"},"ModelRelationType":{"title":"ModelRelationType","enum":["physical","protocol"],"description":"连接类型映射"},"NVR":{"title":"NVR","type":"object","properties":{"channels":{"title":"Channels","type":"array","items":{"$ref":"#/components/schemas/Channel"},"description":"通道"},"storages":{"title":"Storages","type":"array","items":{"$ref":"#/components/schemas/Storage"},"description":"存储"}},"description":"nvr字段"},"NonIntelligent":{"title":"NonIntelligent","type":"object","properties":{"edge_belong":{"title":"Edge Belong","type":"string","description":"所属边代"},"belong":{"title":"Belong","type":"string","description":"所属单位"},"fre_data":{"title":"Fre Data","type":"integer","description":"数据上报频率"},"fre_prop":{"title":"Fre Prop","type":"integer","description":"属性上报频率"},"params":{"title":"Params","type":"array","items":{"type":"string"},"description":"上报参数"}},"description":"非智设备字段"},"PortStatus":{"title":"PortStatus","enum":["up","down","shutdown"],"description":"端口状态映射"},"PortType":{"title":"PortType","enum":["electrical","fibre"],"description":"端口类型映射"},"Probe":{"title":"Probe","type":"object","properties":{"subnets":{"title":"Subnets","type":"array","items":{"type":"string"},"description":"probe 管理网段"},"cert":{"title":"Cert","type":"object","description":"证书"}},"description":"探针字段"},"ProbeUpdate":{"title":"ProbeUpdate","required":["subnets"],"type":"object","properties":{"subnets":{"title":"管理网段列表","type":"array","items":{"type":"string","format":"ipv4interface"}}},"description":"更新探针管理网段"},"Protocol":{"title":"Protocol","enum":["hikvision","dahua","onvif","sony","private"],"description":"协议类型映射"},"RequsetDeviceMerge":{"title":"RequsetDeviceMerge","required":["child_ids"],"type":"object","properties":{"child_ids":{"title":"子设备id列表","type":"array","items":{"type":"string"}}},"description":"合并设备的请求body"},"RequsetDeviceUpdateProbe":{"title":"RequsetDeviceUpdateProbe","type":"object","properties":{"probe":{"title":"探针详细信息","allOf":[{"$ref":"#/components/schemas/ProbeUpdate"}]},"name":{"title":"探针名称","type":"string"}},"description":"更新探针网段"},"RequsetDeviceUpdateType":{"title":"RequsetDeviceUpdateType","required":["devicetype"],"type":"object","properties":{"devicetype":{"title":"设备类型","allOf":[{"$ref":"#/components/schemas/DeviceTypeReverse"}]}},"description":"更新设备类型"},"ResponseTaskStatus":{"title":"ResponseTaskStatus","required":["task_id"],"type":"object","properties":{"task_id":{"title":"任务id","type":"string"},"@timestamp":{"title":"任务时间","type":"string","format":"date-time"},"tasktype":{"title":"任务类型","type":"string"},"task_status":{"title":"任务状态","allOf":[{"$ref":"#/components/schemas/TaskStatus"}],"default":"not_exist"},"devices":{"title":"设备列表","type":"array","items":{"$ref":"#/components/schemas/DeviceDetail"}}},"description":"获取单个任务的状态"},"RunningDevice":{"title":"RunningDevice","required":["id"],"type":"object","properties":{"id":{"title":"设备id","type":"string"},"ip":{"title":"设备ip","type":"string","format":"ipv4"}},"description":"设备运行监控 - 设备详情"},"Status":{"title":"Status","enum":["online","offline"],"description":"设备状态映射"},"Storage":{"title":"Storage","required":["store_type"],"type":"object","properties":{"store_type":{"title":"Store type","allOf":[{"$ref":"#/components/schemas/StoreType"}]},"status":{"title":"State","allOf":[{"$ref":"#/components/schemas/StorageStatus"}]},"capacity":{"title":"Capacity","type":"string","description":"容量"},"free_capacity":{"title":"Free capacity","type":"string","description":"剩余容量"},"unit":{"title":"Unit","type":"string","description":"单位","default":"G"},"index":{"title":"存储编号","type":"integer"}},"description":"nvr存储字段"},"StorageStatus":{"title":"StorageStatus","enum":["normal","non_exisit"],"description":"nvr存储状态映射"},"StoreType":{"title":"StoreType","enum":["local_hd","remote"],"description":"nvr存储类型映射"},"Switch":{"title":"Switch","type":"object","properties":{"vlans":{"title":"Vlans","type":"array","items":{"$ref":"#/components/schemas/Vlan"},"description":"vlans"},"switch_ports":{"title":"Switch Ports","type":"array","items":{"$ref":"#/components/schemas/SwitchPort"}},"ip_manage":{"title":"Ip Manage","type":"string","format":"ipv4"}},"description":"交换机字段"},"SwitchPort":{"title":"SwitchPort","required":["name","mac"],"type":"object","properties":{"name":{"title":"Name","type":"string"},"status":{"title":"Status","anyOf":[{"$ref":"#/components/schemas/PortStatus"},{"type":"string"}]},"port_type":{"allOf":[{"$ref":"#/components/schemas/PortType"}],"default":"electrical"},"mac":{"title":"Mac","type":"string"}},"description":"交换机端口字段"},"TaskStatus":{"title":"TaskStatus","enum":["not_exist","failed","success","beginning"],"description":"任务状态映射"},"ValidationError":{"title":"ValidationError","required":["loc","msg","type"],"type":"object","properties":{"loc":{"title":"Location","type":"array","items":{"type":"string"}},"msg":{"title":"Message","type":"string"},"type":{"title":"Error Type","type":"string"}}},"Vlan":{"title":"Vlan","required":["id"],"type":"object","properties":{"id":{"title":"Id","minimum":1.0,"type":"integer"},"description":{"title":"Description","type":"string"}},"description":"Vlan字段"},"VulnLang":{"title":"VulnLang","enum":["english","chinese","all"],"description":"漏洞语言"}},"securitySchemes":{"APIKeyHeader":{"type":"apiKey","in":"header","name":"AUTHORIZATION"}}}}